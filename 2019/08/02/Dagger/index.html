<html>
<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">

  
  <title>
    Dagger2ä½¿ç”¨ |
    å²è¾°é¾™
  </title>
  


  <meta name="description" content>
  <meta name="author" content="John Doe">
  <meta property="og:title" content="Dagger2ä½¿ç”¨">
  <meta property="og:description" content>
  <meta property="og:site_name" content="å²è¾°é¾™">
  <meta property="og:image" content="http://yoursite.com/img/default.jpg">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:description" content>
  <meta name="twitter:title" content="Dagger2ä½¿ç”¨">

  <meta name="twitter:image" content="http://yoursite.com/img/default.jpg">

  <script src="https://www.amcharts.com/lib/4/core.js"></script>
  <script src="https://www.amcharts.com/lib/4/charts.js"></script>
  <script src="https://www.amcharts.com/lib/4/themes/animated.js"></script>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
  <link rel="stylesheet" href="/./css/style.css">

</head>

<body>
    <!-- Menu -->
    <nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark page-navbar gradient">
  <div class="container">
    <a class="navbar-brand logo" href="http://yoursite.com">
      å²è¾°é¾™</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav"
      aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav mx-auto">
        <li class="nav-item item">
          
        <li class="nav-item item">
          <a class="nav-link" href="/">
            Home</a>
        </li>
        
        <li class="nav-item item">
          <a class="nav-link" href="/archives">
            ğŸ—‚ï¸Archives</a>
        </li>
        
        <li class="nav-item item">
          <a class="nav-link" href="https://hexo.io/">
            Hexo</a>
        </li>
        
        </li>
      </ul>
    </div>
  </div>
</nav>

    <main class="page main-page">
        <div class="container blogPost">
    <div class="row">
        <div class="col-sm-8">
            <h2 class="blog-post-title">
                Dagger2ä½¿ç”¨
            </h2>
            <p class="meta"><i class="far fa-clock"></i>
                2019-08-02
                
            </p>
            <!-- Content -->
            <p><a href="https://dagger.dev/" target="_blank" rel="noopener">Daggerå®˜ç½‘</a></p>
<p>Daggeræ˜¯ä¸€ä¸ªå®Œå…¨é™æ€çš„ã€ç¼–è¯‘æ—¶ä¾èµ– æ³¨å…¥æ¡†æ¶ ï¼Œé€‚ç”¨äºJavaå’ŒAndroidã€‚å®ƒæ˜¯Squareåˆ›å»ºçš„æ—©æœŸç‰ˆæœ¬çš„ä¸€ä¸ªæ”¹ç¼–ç‰ˆæœ¬ï¼Œç°åœ¨ç”±è°·æ­Œç»´æŠ¤ã€‚</p>
<h2 id="è¯´è¯´ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥"><a href="#è¯´è¯´ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥" class="headerlink" title="è¯´è¯´ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥?"></a><strong>è¯´è¯´ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥?</strong></h2><hr>
<p>ä¾èµ–æ³¨å…¥å¯¹äºåˆšæ¥è§¦åˆ°è¿™ä¸ªæ¦‚å¿µçš„åŒå­¦å¯èƒ½ä¸å¤ªæ¸…æ¥šä»€ä¹ˆæ„æ€ï¼Œè¯´èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ç”šè‡³æˆ‘ä»¬æ¯å¤©éƒ½åœ¨ç¼–å†™è¿™æ ·çš„ä»£ç ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class A&#123;</span><br><span class="line">    private B b;</span><br><span class="line">    public A(B _b)&#123;</span><br><span class="line">        this.b = _b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç æ˜¯ä¸æ˜¯å¾ˆå¸¸è§ï¼Œæˆ‘ä»¬å‘ç°ä¸šåŠ¡ç±»Aä¾èµ–äº†ä¸šåŠ¡ç±»Bã€‚<br>è¿™å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¾èµ–æ³¨å…¥ã€‚<br>é‚£æˆ‘ä»¬æ¥æƒ³æƒ³å¦‚æœAè¢«å¾ˆå¤šçš„å…¶ä»–ä¸šåŠ¡ç±»ä¾èµ–å¦‚æœAåšäº†ä¿®æ”¹æ˜¯ä¸æ˜¯è¦ä¿®æ”¹å¾ˆå¤šçš„åœ°æ–¹å‘¢ï¼Ÿ<br>è¿™æ ·æˆ‘ä»¬çš„Daggerå°±åº”è¯¥ç™»åœºäº†ï¼ŒDaggerå°±ä¸ºäº†è§£å†³æ­¤ç±»é—®é¢˜è€Œç”Ÿçš„ã€‚</p>
<p>ç®€å•å®ç”¨ï¼š</p>
<p><strong>å¯¼ä¾èµ–</strong></p>
<p>buildã€‚gradleä¸­å¯¼å…¥ä¾èµ–å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation &apos;com.google.dagger:dagger-android:2.17&apos;</span><br><span class="line">    annotationProcessor&quot;com.google.dagger:dagger-compiler:2.17&quot;</span><br><span class="line">    implementation &apos;com.google.dagger:dagger-android-support:2.17&apos; // if you use the support libraries</span><br><span class="line">    annotationProcessor &apos;com.google.dagger:dagger-android-processor:2.17&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸šåŠ¡ç±»ClassA</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">package com.baweigame.daggerdemoapplication;</span><br><span class="line"></span><br><span class="line">import javax.inject.Inject;</span><br><span class="line"></span><br><span class="line">public class ClassA &#123;</span><br><span class="line">    @Inject</span><br><span class="line">    public ClassA()&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int Add(int a,int b)&#123;</span><br><span class="line">        return a+b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸šåŠ¡ç±»ClassB</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">package com.baweigame.daggerdemoapplication;</span><br><span class="line"></span><br><span class="line">import javax.inject.Inject;</span><br><span class="line"></span><br><span class="line">public class ClassB &#123;</span><br><span class="line">    @Inject</span><br><span class="line">    public ClassB()&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Inject</span><br><span class="line">    ClassA classA;</span><br><span class="line"></span><br><span class="line">    public int Add(int a,int b)&#123;</span><br><span class="line">        return classA.Add(a,b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>MainActivityComponent</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">package com.baweigame.daggerdemoapplication;</span><br><span class="line"></span><br><span class="line">import android.app.Activity;</span><br><span class="line"></span><br><span class="line">import dagger.Component;</span><br><span class="line"></span><br><span class="line">@Component</span><br><span class="line">public interface MainActivityComponent&#123;</span><br><span class="line">    void inject(MainActivity activity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>MainActivity</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">package com.baweigame.daggerdemoapplication;</span><br><span class="line"></span><br><span class="line">import android.app.Activity;</span><br><span class="line">import android.support.v7.app.AppCompatActivity;</span><br><span class="line">import android.os.Bundle;</span><br><span class="line">import android.view.View;</span><br><span class="line">import android.widget.TextView;</span><br><span class="line">import android.widget.Toast;</span><br><span class="line"></span><br><span class="line">import javax.inject.Inject;</span><br><span class="line"></span><br><span class="line">import dagger.Component;</span><br><span class="line"></span><br><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line">    private TextView tvTest;</span><br><span class="line"></span><br><span class="line">    @Inject</span><br><span class="line">    ClassB classB;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        initView();</span><br><span class="line">        initListener();</span><br><span class="line"></span><br><span class="line">        DaggerMainActivityComponent.create().inject(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void initListener() &#123;</span><br><span class="line">        tvTest.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View v) &#123;</span><br><span class="line">                Toast.makeText(MainActivity.this, &quot;&quot;+classB.Add(2,3), Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void initView() &#123;</span><br><span class="line">        tvTest = (TextView) findViewById(R.id.tv_test);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çœ‹ä¸Šé¢çš„ä¾‹å­ï¼Œæ¯”è¾ƒç®€å•ï¼Œé¦–å…ˆä¸šåŠ¡ç±»Bä¾èµ–äº†ä¸šåŠ¡ç±»Aï¼ŒMainActivityä¾èµ–äº†ä¸šåŠ¡ç±»Bï¼Œæˆ‘ä»¬å‘ç°ç”¨Daggerå®ç°èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆæ¸…çˆ½ã€‚å¦‚æœæˆ‘ä»¬ä¸ç”¨Daggeræˆ‘çš„ä»£ç å¤§æ¦‚åº”è¯¥æ˜¯ä¸‹é¢çš„æ ·å­ï¼š</p>
<p><strong>â€“ä¸€æ®µä¼ªä»£ç </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ClassA classA=new ClassA();</span><br><span class="line">ClassB classB=new ClassB();</span><br><span class="line">classB.set(classA);</span><br><span class="line"></span><br><span class="line">classB.Add(2,3);</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨Dagger2</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Inject</span><br><span class="line">ClassB classB;</span><br><span class="line"></span><br><span class="line">classB.Add(2,3);</span><br></pre></td></tr></table></figure>

<p>æ„Ÿè§‰æ˜¯ä¸æ˜¯å¾ˆç®€æ´ã€‚<br>ä¸Šé¢çš„ä¾‹å­ä¸­å‡ºç°äº†ä¸€äº›æ–°çš„â€ä¸œè¥¿â€ï¼Œæˆ‘ä»¬å‘ç°å¤§å¤šå‡ºç°çš„æ˜¯æ³¨è§£ã€‚</p>
<hr>
<p>ä¸‹é¢æ˜¯Daggerçš„å¸¸ç”¨æ³¨è§£ã€‚</p>
<p><strong>Componetæ³¨è§£</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Retention(value=RUNTIME)</span><br><span class="line">@Target(value=TYPE)</span><br><span class="line">@Documented</span><br><span class="line">public @interface Component &#123;</span><br><span class="line">    Class&lt;?&gt;[] modules() default &#123;&#125;;</span><br><span class="line">    Class&lt;?&gt;[] dependencies() default &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒé“¾æ¥:<a href="https://dagger.dev/api/latest/dagger/Component.html" target="_blank" rel="noopener">https://dagger.dev/api/latest/dagger/Component.html</a></p>
<p>æ³¨é‡Šæ¥å£æˆ–æŠ½è±¡ç±»ï¼Œä¸ºå…¶ä»ä¸€ç»„æ¨¡å—ç”Ÿæˆæ³¨å…¥ä¾èµ–å…³ç³»çš„å®ç°ã€‚ç”Ÿæˆçš„ç±»çš„ç±»å‹åç§°å°†å¸¦æœ‰@Componentæ³¨é‡Šï¼Œå‰ç¼€ä¸ºDaggerã€‚ä¾‹å¦‚ï¼Œ@Component interface MyComponent{â€¦}å°†ç”Ÿæˆä¸€ä¸ªåä¸ºDaggerMyComponentçš„å®ç°ã€‚</p>
<p><strong>Subcomponentæ³¨è§£</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Retention(value=RUNTIME)</span><br><span class="line">@Target(value=TYPE)</span><br><span class="line">@Documented</span><br><span class="line">public @interface Subcomponent &#123;</span><br><span class="line">    Class&lt;?&gt;[] modules() default &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒé“¾æ¥:<a href="https://dagger.dev/api/latest/dagger/Subcomponent.html" target="_blank" rel="noopener">https://dagger.dev/api/latest/dagger/Subcomponent.html</a></p>
<p>ä»çˆ¶ç»„ä»¶æˆ–å­ç»„ä»¶ç»§æ‰¿ç»‘å®šçš„å­ç»„ä»¶</p>
<p><strong>Moduleæ³¨è§£</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Documented</span><br><span class="line">@Retention(value=RUNTIME)</span><br><span class="line">@Target(value=TYPE)</span><br><span class="line">public @interface Module&#123;</span><br><span class="line">    Class&lt;?&gt;[] includes() default &#123;&#125;;</span><br><span class="line">    Class&lt;?&gt;[] subcomponents default &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒé“¾æ¥:<a href="https://dagger.dev/api/latest/dagger/Module.html" target="_blank" rel="noopener">https://dagger.dev/api/latest/dagger/Module.html</a></p>
<p><strong>Providesæ³¨è§£</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Documented</span><br><span class="line">@Target(value=METHOD)</span><br><span class="line">@Retention(value=RUNTIME)</span><br><span class="line">public @interface Provides&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒé“¾æ¥:<a href="https://dagger.dev/api/latest/dagger/Provides.html" target="_blank" rel="noopener">https://dagger.dev/api/latest/dagger/Provides.html</a></p>
<p>æ³¨é‡Šæ¨¡å—çš„æ–¹æ³•ï¼Œä»¥åˆ›å»ºæä¾›ç¨‹åºæ–¹æ³•ç»‘å®šã€‚æ–¹æ³•çš„è¿”å›ç±»å‹ç»‘å®šåˆ°å…¶è¿”å›å€¼ã€‚ç»„ä»¶å®ç°å°†ä¾èµ–é¡¹ä½œä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•ã€‚</p>
<p><strong>MapKey æ³¨è§£</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Documented</span><br><span class="line">@Target(value=ANNOTATION_TYPE)</span><br><span class="line">@Retention(value=RUNTIME)</span><br><span class="line">public @interface MapKey&#123;</span><br><span class="line">    boolean unwrapValue() default true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://dagger.dev/api/latest/dagger/MapKey.html" target="_blank" rel="noopener">https://dagger.dev/api/latest/dagger/MapKey.html</a></p>
<p>æ ‡è¯†ç”¨äºå°†Keyä¸æ–¹æ³•è¿”å›çš„å€¼å…³è”ä»¥ç»„æˆæ˜ å°„çš„æ³¨é‡Šç±»å‹ã€‚<br>æ¯ä¸ªä½¿ç”¨@ provideå’Œ@IntoMapæ³¨é‡Šçš„æä¾›ç¨‹åºæ–¹æ³•éƒ½å¿…é¡»æœ‰ä¸€ä¸ªæ³¨é‡Šæ¥æ ‡è¯†æ˜ å°„æ¡ç›®çš„é”®ã€‚è¯¥æ³¨é‡Šçš„ç±»å‹å¿…é¡»ä½¿ç”¨@MapKeyè¿›è¡Œæ³¨é‡Šã€‚<br>é€šå¸¸ï¼Œé”®æ³¨é‡Šåªæœ‰ä¸€ä¸ªæˆå‘˜ï¼Œå…¶å€¼ç”¨ä½œæ˜ å°„é”®ã€‚</p>
<p><strong>Dagger 2ä¸­ç”¨åˆ°çš„å®šä¹‰åœ¨ JSR-330çš„å…¶ä»–æ³¨è§£</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public @interface Inject &#123;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public @interface Scope &#123;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public @interface Qualifier &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬æ¥è§¦åˆ°äº†@Injectå’Œ@Componentä¸¤ä¸ªæ³¨è§£ï¼Œä¸‹é¢æ¥è¯´è¯´è¿™ä¸¤ä¸ªæ³¨è§£æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Ÿ<br>å¦‚æœæƒ³ä½¿ç”¨Daggeræ¥å®ç°ä¾èµ–æ³¨å…¥å°±è‡³å°‘è¦ä½¿ç”¨è¿™ä¸¤ä¸ªæ³¨è§£ï¼š<br>@Injectç”¨äºæ ‡è®°éœ€è¦æ³¨å…¥çš„ä¾èµ–ï¼Œæˆ–è€…æ ‡è®°ç”¨äºæä¾›ä¾èµ–çš„æ–¹æ³•ã€‚<br>ä¾èµ–æ³¨å…¥ä¸­æœ€é‡è¦çš„æ³¨è§£ï¼ŒJSR-330æ ‡å‡†ä¸­çš„ä¸€éƒ¨åˆ†åœ¨javax.injectåŒ…ä¸­ã€‚</p>
<p>Dagger 2ä¸­æœ‰3ç§æ–¹å¼æä¾›ä¾èµ–ï¼š</p>
<p>1ã€æ„é€ å‡½æ•°æ³¨å…¥ï¼Œå¦‚æˆ‘ä»¬ä¸Šé¢ä¾‹å­ä¸­çš„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ClassA:</span><br><span class="line"></span><br><span class="line">@Inject</span><br><span class="line">public ClassA()&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨ï¼šå¦‚æœå­˜åœ¨å¤šä¸ªæ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬åªèƒ½æ ‡æ³¨ä¸€ä¸ªï¼Œä¸èƒ½åŒæ—¶æ ‡æ³¨å¤šä¸ªã€‚</p>
<p>2ã€å±æ€§æ³¨å…¥<br>æ³¨ï¼šè¢«æ ‡æ³¨çš„å±æ€§ä¸èƒ½ä½¿ç”¨privateä¿®é¥°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@Inject</span><br><span class="line">ClassB b;</span><br></pre></td></tr></table></figure>

<p>3ã€æ–¹æ³•æ³¨å…¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Inject</span><br><span class="line">public void setClassB(ClassB _b) &#123;</span><br><span class="line">    this.b = _b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•æ³¨å…¥ä¸å±æ€§æ³¨å…¥åŸºæœ¬ä¸Šæ²¡åŒºåˆ«ï¼ŒDagger2ä¼šåœ¨æ„é€ æ‰§è¡Œå®Œç«‹å³è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬éœ€è¦ä½¿ç”¨thisçš„æ—¶å€™ï¼Œä½¿ç”¨æ–¹æ³•æ³¨å…¥æ˜¯å®‰å…¨çš„ã€‚</p>
<p>@Componentç”¨æ¥å®Œæˆæ³¨å…¥ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ç›®æ ‡MainActivityå°±æ˜¯ä½¿ç”¨Componentå®Œæˆæ³¨å…¥ã€‚<br>@Componentæ˜¯Dagger2ä¸­æœ€é‡è¦çš„ä¸€ä¸ªæ³¨è§£ï¼ŒDagger2æ˜¯ä½¿ç”¨å®ƒæ¥å®Œæˆä¾èµ–æ³¨å…¥çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">public interface MainActivityComponent&#123;</span><br><span class="line">    void inject(MainActivity activity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æ˜¯æˆ‘ä»¬ä¸Šé¢ä¾‹å­ä¸­çš„æ¥å£ï¼Œä½¿ç”¨Componentçš„ä½¿ç”¨æ–¹å¼ï¼Œå‘½åä¸€èˆ¬ç”¨ ç±»å+Component æ–¹å¼ï¼Œæˆ‘ä»¬rebuildå·¥ç¨‹åï¼ŒDagger2ä¼šç”Ÿæˆä¸€ä¸ªDagger+XXXï¼ˆå¦‚ï¼šDaggerMainActivityComponentï¼‰çš„ç±»ã€‚</p>
<p><strong>Componentä¸­ä¸€èˆ¬ä½¿ç”¨ä¸¤ç§æ–¹å¼å®šä¹‰æ–¹æ³•ã€‚</strong></p>
<p>void inject(ç›®æ ‡ç±» obj);<br>Dagger2ä¼šä»ç›®æ ‡ç±»å¼€å§‹æŸ¥æ‰¾@Injectæ³¨è§£ï¼Œè‡ªåŠ¨ç”Ÿæˆä¾èµ–æ³¨å…¥çš„ä»£ç ï¼Œè°ƒç”¨injectå¯å®Œæˆä¾èµ–çš„æ³¨å…¥ã€‚</p>
<p>Object getObj(); å¦‚ï¼šClassB getClassB();<br>Dagger2ä¼šåˆ°ClassBç±»ä¸­æ‰¾è¢«@Injectæ³¨è§£æ ‡æ³¨çš„æ„é€ å™¨ï¼Œè‡ªåŠ¨ç”Ÿæˆæä¾›ClassBä¾èµ–çš„ä»£ç ï¼Œè¿™ç§æ–¹å¼ä¸€èˆ¬ä¸ºå…¶ä»–Componentæä¾›ä¾èµ–ã€‚</p>
<p>Dagger2ä»¥@Componentä¸­å®šä¹‰çš„æ–¹æ³•ä½œä¸ºèµ·ç‚¹ï¼Œåˆ°ç›®æ ‡ç±»ä¸­å¯»æ‰¾@Injectæ ‡æ³¨ï¼Œç”Ÿæˆä¸€ç³»åˆ—æä¾›ä¾èµ–çš„Factoryç±»å’Œæ³¨å…¥ä¾èµ–çš„Injectorç±»ã€‚<br>è€ŒComponentåˆ™æ˜¯è”ç³»Factoryå’ŒInjectorï¼Œæœ€ç»ˆå®Œæˆä¾èµ–çš„æ³¨å…¥ã€‚</p>
<p><img src="2019-08-02-20-55-09.png" alt></p>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹Dagger2ç”Ÿæˆçš„ç±»ï¼Œæˆ‘ä»¬å‘ç°ClassA_Factory ClassB_Factory è¿™ä¸¤ä¸ªç±»åˆ†åˆ«å¯¹åº”æˆ‘ä»¬çš„ClassA ClassBæ„é€ å‡½æ•°ä¸Šçš„@Injectæ³¨è§£ã€‚</p>
<p>Factoryç±»</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * An &#123;@linkplain Scope unscoped&#125; &#123;@link Provider&#125;. While a &#123;@link Provider&#125; &lt;i&gt;may&lt;/i&gt; apply</span><br><span class="line"> * scoping semantics while providing an instance, a factory implementation is guaranteed to exercise</span><br><span class="line"> * the binding logic (&#123;@link Inject&#125; constructors, &#123;@link Provides&#125; methods) upon each call to</span><br><span class="line"> * &#123;@link #get&#125;.</span><br><span class="line"> *</span><br><span class="line"> * &lt;p&gt;Note that while subsequent calls to &#123;@link #get&#125; will create new instances for bindings such</span><br><span class="line"> * as those created by &#123;@link Inject&#125; constructors, a new instance is not guaranteed by all</span><br><span class="line"> * bindings. For example, &#123;@link Provides&#125; methods may be implemented in ways that return the same</span><br><span class="line"> * instance for each call.</span><br><span class="line"> */</span><br><span class="line">public interface Factory&lt;T&gt; extends Provider&lt;T&gt; &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çœ‹ClassA_Factoryè¿™ä¸ªå·¥å‚ç±»ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// Generated by Dagger (https://google.github.io/dagger).</span><br><span class="line">package com.baweigame.daggerdemoapplication;</span><br><span class="line"></span><br><span class="line">import dagger.internal.Factory;</span><br><span class="line"></span><br><span class="line">public final class ClassA_Factory implements Factory&lt;ClassA&gt; &#123;</span><br><span class="line">  private static final ClassA_Factory INSTANCE = new ClassA_Factory();</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public ClassA get() &#123;</span><br><span class="line">    return provideInstance();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static ClassA provideInstance() &#123;</span><br><span class="line">    return new ClassA();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static ClassA_Factory create() &#123;</span><br><span class="line">    return INSTANCE;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static ClassA newClassA() &#123;</span><br><span class="line">    return new ClassA();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå·¥å‚ç±»ä½¿ç”¨å•ä¾‹æ¨¡å¼ç»™æˆ‘ä»¬æä¾›äº†å®ä¾‹åŒ–ClassAçš„æ–¹æ³•ã€‚<br>å†çœ‹çœ‹ClassB_Factoryï¼š<br>ClassBä¾èµ–äº†ClassAï¼Œæ‰€æœ‰å°†ClassA Providerç›´æ¥ä¼ å…¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">// Generated by Dagger (https://google.github.io/dagger).</span><br><span class="line">package com.baweigame.daggerdemoapplication;</span><br><span class="line"></span><br><span class="line">import dagger.internal.Factory;</span><br><span class="line">import javax.inject.Provider;</span><br><span class="line"></span><br><span class="line">public final class ClassB_Factory implements Factory&lt;ClassB&gt; &#123;</span><br><span class="line">  private final Provider&lt;ClassA&gt; classAProvider;</span><br><span class="line"></span><br><span class="line">  public ClassB_Factory(Provider&lt;ClassA&gt; classAProvider) &#123;</span><br><span class="line">    this.classAProvider = classAProvider;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public ClassB get() &#123;</span><br><span class="line">    return provideInstance(classAProvider);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static ClassB provideInstance(Provider&lt;ClassA&gt; classAProvider) &#123;</span><br><span class="line">    ClassB instance = new ClassB();</span><br><span class="line">    ClassB_MembersInjector.injectClassA(instance, classAProvider.get());</span><br><span class="line">    return instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static ClassB_Factory create(Provider&lt;ClassA&gt; classAProvider) &#123;</span><br><span class="line">    return new ClassB_Factory(classAProvider);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static ClassB newClassB() &#123;</span><br><span class="line">    return new ClassB();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MainActivityä¸Šçš„@Injectç›´æ¥å¯¹åº”MainActivity_MembersInjector,ä¾èµ–äº†ClassBï¼Œæ‰€ä»¥ClassB Providerä½œä¸ºå‚æ•°ä¸ç›´æ¥ä¼ é€’ã€‚<br>å®ç°äº†MembersInjectoræ¥å£</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * Copyright (C) 2012 The Dagger Authors.</span><br><span class="line"> *</span><br><span class="line"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><br><span class="line"> * you may not use this file except in compliance with the License.</span><br><span class="line"> * You may obtain a copy of the License at</span><br><span class="line"> *</span><br><span class="line"> * http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="line"> *</span><br><span class="line"> * Unless required by applicable law or agreed to in writing, software</span><br><span class="line"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class="line"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="line"> * See the License for the specific language governing permissions and</span><br><span class="line"> * limitations under the License.</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">package dagger;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Injects dependencies into the fields and methods on instances of type &#123;@code T&#125;. Ignores the</span><br><span class="line"> * presence or absence of an injectable constructor.</span><br><span class="line"> *</span><br><span class="line"> * @param &lt;T&gt; type to inject members of</span><br><span class="line"> *</span><br><span class="line"> * @since 2.0 (since 1.0 without the provision that &#123;@link #injectMembers&#125; cannot accept</span><br><span class="line"> *      &#123;@code null&#125;)</span><br><span class="line"> */</span><br><span class="line">public interface MembersInjector&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">  /**</span><br><span class="line">   * Injects dependencies into the fields and methods of &#123;@code instance&#125;. Ignores the presence or</span><br><span class="line">   * absence of an injectable constructor.</span><br><span class="line">   *</span><br><span class="line">   * &lt;p&gt;Whenever a &#123;@link Component&#125; creates an instance, it performs this injection automatically</span><br><span class="line">   * (after first performing constructor injection), so if you&apos;re able to let the component create</span><br><span class="line">   * all your objects for you, you&apos;ll never need to use this method.</span><br><span class="line">   *</span><br><span class="line">   * @param instance into which members are to be injected</span><br><span class="line">   * @throws NullPointerException if &#123;@code instance&#125; is &#123;@code null&#125;</span><br><span class="line">   */</span><br><span class="line">  void injectMembers(T instance);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// Generated by Dagger (https://google.github.io/dagger).</span><br><span class="line">package com.baweigame.daggerdemoapplication;</span><br><span class="line"></span><br><span class="line">import dagger.MembersInjector;</span><br><span class="line">import javax.inject.Provider;</span><br><span class="line"></span><br><span class="line">public final class MainActivity_MembersInjector implements MembersInjector&lt;MainActivity&gt; &#123;</span><br><span class="line">  private final Provider&lt;ClassB&gt; classBProvider;</span><br><span class="line"></span><br><span class="line">  public MainActivity_MembersInjector(Provider&lt;ClassB&gt; classBProvider) &#123;</span><br><span class="line">    this.classBProvider = classBProvider;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static MembersInjector&lt;MainActivity&gt; create(Provider&lt;ClassB&gt; classBProvider) &#123;</span><br><span class="line">    return new MainActivity_MembersInjector(classBProvider);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public void injectMembers(MainActivity instance) &#123;</span><br><span class="line">    injectClassB(instance, classBProvider.get());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static void injectClassB(MainActivity instance, ClassB classB) &#123;</span><br><span class="line">    instance.classB = classB;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€åæ¥çœ‹çœ‹æˆ‘ä»¬çš„@Component -&gt; DaggerMainActivityComponent å®ƒå°†Factoryå’ŒMainActivityä¸¤ä¸ªç±»è”ç³»åˆ°ä¸€èµ·ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">// Generated by Dagger (https://google.github.io/dagger).</span><br><span class="line">package com.baweigame.daggerdemoapplication;</span><br><span class="line"></span><br><span class="line">public final class DaggerMainActivityComponent implements MainActivityComponent &#123;</span><br><span class="line">  private DaggerMainActivityComponent(Builder builder) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  public static Builder builder() &#123;</span><br><span class="line">    return new Builder();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static MainActivityComponent create() &#123;</span><br><span class="line">    return new Builder().build();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private ClassB getClassB() &#123;</span><br><span class="line">    return injectClassB(ClassB_Factory.newClassB());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public void inject(MainActivity activity) &#123;</span><br><span class="line">    injectMainActivity(activity);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private ClassB injectClassB(ClassB instance) &#123;</span><br><span class="line">    ClassB_MembersInjector.injectClassA(instance, new ClassA());</span><br><span class="line">    return instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private MainActivity injectMainActivity(MainActivity instance) &#123;</span><br><span class="line">    MainActivity_MembersInjector.injectClassB(instance, getClassB());</span><br><span class="line">    return instance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static final class Builder &#123;</span><br><span class="line">    private Builder() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    public MainActivityComponent build() &#123;</span><br><span class="line">      return new DaggerMainActivityComponent(this);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>@Moduleå’Œ@Provides</strong><br>è¿™ä¸¤ä¸ªæ³¨è§£ä¸»è¦å¼¥è¡¥@Injectçš„ä¸è¶³ï¼Œå› ä¸ºåœ¨ä¸€äº›åœºæ™¯ä¸‹æ— æ³•ä½¿ç”¨@Injectï¼Œæ¯”å¦‚ï¼šç¬¬ä¸‰æ–¹åº“æˆ–è€…æŠ½è±¡ç±»ä¸­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">package com.baweigame.daggerdemoapplication;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * äººç±»</span><br><span class="line"> */</span><br><span class="line">public abstract class Person &#123;</span><br><span class="line">    /**</span><br><span class="line">     * è¯´è¯</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public abstract String speak();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">package com.baweigame.daggerdemoapplication;</span><br><span class="line"></span><br><span class="line">import javax.inject.Inject;</span><br><span class="line"></span><br><span class="line">public class ChinaPerson extends Person &#123;</span><br><span class="line">    @Inject</span><br><span class="line">    ChinaPerson()&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public String speak() &#123;</span><br><span class="line">        return &quot;ä¸­å›½äººè¯´è¯&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">package com.baweigame.daggerdemoapplication;</span><br><span class="line"></span><br><span class="line">import javax.inject.Inject;</span><br><span class="line"></span><br><span class="line">public class AmericaPerson extends Person &#123;</span><br><span class="line">    @Inject</span><br><span class="line">    AmericaPerson()&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public String speak() &#123;</span><br><span class="line">        return &quot;ç¾å›½äººè¯´è¯&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">package com.baweigame.daggerdemoapplication;</span><br><span class="line"></span><br><span class="line">import javax.inject.Inject;</span><br><span class="line"></span><br><span class="line">public class PersonManager &#123;</span><br><span class="line">    Person person;</span><br><span class="line">    @Inject</span><br><span class="line">    public PersonManager(Person _person)&#123;</span><br><span class="line">        this.person=_person;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public String speak()&#123;</span><br><span class="line">        return person.speak();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬åœ¨MainActivityä¸­åŠ å…¥å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Inject</span><br><span class="line">PersonManager person;</span><br><span class="line"></span><br><span class="line"> tvTest.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View v) &#123;</span><br><span class="line">                person.speak();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<p>é‡æ–°buildè¿è¡Œæˆ‘ä»¬çš„å·¥ç¨‹ï¼Œæˆ‘ä»¬å‘ç°å‡ºç°äº†é”™è¯¯ã€‚å› ä¸ºPersonæ˜¯ä¸ªæŠ½è±¡ç±»æ— æ³•å®ä¾‹åŒ–ã€‚<br>æ€ä¹ˆè§£å†³ç±»ä¼¼è¿™æ ·çš„é—®é¢˜å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨@Module @Providesè¿™ä¸¤ä¸ªæ³¨è§£æ¥è§£å†³ï¼Œæ³¨æ„è¿™ä¸¤ä¸ªæ³¨è§£æ˜¯æˆå¯¹å‡ºç°ä½¿ç”¨çš„ï¼Œ@Moduleä¿®é¥°åœ¨ ç±» ä¸Šï¼Œ@Providesä¿®é¥°åœ¨ æ–¹æ³• ä¸Šã€‚<br>æˆ‘ä»¬æŠŠåˆšæ‰çš„ä¾‹å­é‡æ–°ä¿®æ”¹ä¸€ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * äººç±»</span><br><span class="line"> */</span><br><span class="line">public abstract class Person &#123;</span><br><span class="line">    /**</span><br><span class="line">     * è¯´è¯</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public abstract String speak();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class ChinaPerson extends Person &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public String speak() &#123;</span><br><span class="line">        return &quot;ä¸­å›½äººè¯´è¯&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class AmericaPerson extends Person &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String speak() &#123;</span><br><span class="line">        return &quot;ç¾å›½äººè¯´è¯&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class PersonManager &#123;</span><br><span class="line">    Person person;</span><br><span class="line">    @Inject</span><br><span class="line">    public PersonManager(Person _person)&#123;</span><br><span class="line">        this.person=_person;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public String speak()&#123;</span><br><span class="line">        return person.speak();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Module</span><br><span class="line">public class PersonModule &#123;</span><br><span class="line"></span><br><span class="line">    @Provides</span><br><span class="line">    Person getChinaPerson()&#123;</span><br><span class="line">        return new ChinaPerson();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Component(modules=PersonModule.class)</span><br><span class="line">public interface MainActivityComponent&#123;</span><br><span class="line">    void inject(MainActivity activity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainActivityä¸­</span><br><span class="line"></span><br><span class="line">@Inject</span><br><span class="line">PersonManager personManager;</span><br><span class="line"></span><br><span class="line">private void initListener() &#123;</span><br><span class="line">      tvTest.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">          @Override</span><br><span class="line">          public void onClick(View v) &#123;</span><br><span class="line"></span><br><span class="line">              Toast.makeText(MainActivity.this,  &quot;&quot;+personManager.speak(), Toast.LENGTH_SHORT).show();</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>  æˆ‘ä»¬å‘ç°åŸæ¥çš„ä¸¤ä¸ªå®ç°ç±»å»æ‰äº†æ„é€ å‡½æ•°çš„@Injectï¼Œè€Œä¸”åŠ å…¥äº†PersonModuleç±»ï¼Œå¹¶åœ¨MainActivityComponentç±»çš„@Componentæ³¨è§£ä¸­æŒ‡å®šäº†æˆ‘ä»¬çš„Module &gt;&gt;&gt;&gt; modules=PersonModule.classã€‚æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªModuleæ˜¯å¹²ä»€ä¹ˆç”¨çš„</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">  // Generated by Dagger (https://google.github.io/dagger).</span><br><span class="line">package com.baweigame.daggerdemoapplication;</span><br><span class="line"></span><br><span class="line">import dagger.internal.Factory;</span><br><span class="line">import dagger.internal.Preconditions;</span><br><span class="line"></span><br><span class="line">public final class PersonModule_GetChinaPersonFactory implements Factory&lt;Person&gt; &#123;</span><br><span class="line">  private final PersonModule module;</span><br><span class="line"></span><br><span class="line">  public PersonModule_GetChinaPersonFactory(PersonModule module) &#123;</span><br><span class="line">    this.module = module;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Override</span><br><span class="line">  public Person get() &#123;</span><br><span class="line">    return provideInstance(module);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static Person provideInstance(PersonModule module) &#123;</span><br><span class="line">    return proxyGetChinaPerson(module);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static PersonModule_GetChinaPersonFactory create(PersonModule module) &#123;</span><br><span class="line">    return new PersonModule_GetChinaPersonFactory(module);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public static Person proxyGetChinaPerson(PersonModule instance) &#123;</span><br><span class="line">    return Preconditions.checkNotNull(</span><br><span class="line">        instance.getChinaPerson(), &quot;Cannot return null from a non-@Nullable @Provides method&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å‘ç°è¿™ä¸ªModuleä¹Ÿæ˜¯ä¸€ä¸ªFactoryç±»ã€‚</p>
<p>Moduleæ˜¯å‘Šè¯‰Componentï¼Œå¯ä»¥ä»è¿™é‡Œå¯»æ‰¾ä¾èµ–å¯¹è±¡ã€‚Componentå°±ä¼šå»æ‰¾@Provideæ ‡æ³¨çš„æ–¹æ³•ï¼Œç›¸å½“äºæ„é€ å™¨çš„@Injectï¼Œæ¥æä¾›ä¾èµ–ã€‚</p>
<p>æ³¨ï¼š @Componentå¯ä»¥æŒ‡å®šå¤šä¸ª@Module Componentä¹Ÿå¯ä»¥ä¾èµ–å…¶å®ƒComponent</p>
<p><strong>@Qualifierå’Œ@Named</strong><br>@Qualifieræ˜¯é™å®šç¬¦ï¼Œè€Œ@Namedåˆ™æ˜¯åŸºäºStringçš„é™å®šç¬¦ã€‚<br>å¦‚ä¸Šé¢çš„ä¾‹å­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@Module</span><br><span class="line">public class PersonModule &#123;</span><br><span class="line"></span><br><span class="line">    @Provides</span><br><span class="line">    Person getChinaPerson()&#123;</span><br><span class="line">        return new ChinaPerson();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Provides</span><br><span class="line">    Person getAmericaPerson()&#123;</span><br><span class="line">        return new AmericaPerson();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Moduleä¸­æœ‰å¤šä¸ªå®ç°ä¹‹ç±»ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡é™å®šç¬¦å¯¹å…¶åŒºåˆ†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Module</span><br><span class="line">public class PersonModule &#123;</span><br><span class="line"></span><br><span class="line">    @Provides</span><br><span class="line">    @Named(&quot;china&quot;)</span><br><span class="line">    Person getChinaPerson()&#123;</span><br><span class="line">        return new ChinaPerson();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Provides</span><br><span class="line">    @Named(&quot;america&quot;)</span><br><span class="line">    Person getAmericaPerson()&#123;</span><br><span class="line">        return new AmericaPerson();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¾èµ–æ—¶ï¼Œå¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class PersonManager &#123;</span><br><span class="line">    Person person;</span><br><span class="line">    @Inject</span><br><span class="line">    public PersonManager(@Named(&quot;america&quot;) Person _person)&#123;</span><br><span class="line">        this.person=_person;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String speak()&#123;</span><br><span class="line">        return person.speak();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯â€œAmericaPersonâ€å®ä¾‹ã€‚<br>@Qualifieræ³¨è§£ä¸@Namedæ³¨è§£ä½œç”¨å®Œå…¨ä¸€æ ·ï¼Œä½†æˆ‘ä»¬å‘ç°@Namedæ³¨è§£æœ‰ä¸ªå¼Šç«¯å°±æ˜¯æˆ‘ä»¬è¦æ‰‹å†™å­—ç¬¦ä¸²åç§°ï¼Œè¿™æ ·å¾ˆå®¹æ˜“å‡ºé”™ã€‚<br>@Qualifieræ³¨è§£å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†è¯¥æ³¨è§£æ˜¯ä¿®é¥°åœ¨æ³¨è§£ä¸Šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¿™æ ·ä½¿ç”¨ï¼Œå¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">@Module</span><br><span class="line">public class PersonModule &#123;</span><br><span class="line"></span><br><span class="line">    @Provides</span><br><span class="line">    @ChinaPersonAnn</span><br><span class="line">    Person getChinaPerson()&#123;</span><br><span class="line">        return new ChinaPerson();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Provides</span><br><span class="line">    @AmericaPersonAnn</span><br><span class="line">    Person getAmericaPerson()&#123;</span><br><span class="line">        return new AmericaPerson();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Qualifier</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">@interface ChinaPersonAnn &#123;&#125;</span><br><span class="line"></span><br><span class="line">@Qualifier</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">@interface AmericaPersonAnn &#123;&#125;</span><br><span class="line"></span><br><span class="line">public class PersonManager &#123;</span><br><span class="line">    Person person;</span><br><span class="line">    @Inject</span><br><span class="line">    public PersonManager(@ChinaPersonAnn Person _person)&#123;</span><br><span class="line">        this.person=_person;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String speak()&#123;</span><br><span class="line">        return person.speak();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>@Componentçš„dependenceå’Œ@SubComponent</strong></p>
<p>ä¸Šé¢æˆ‘ä»¬è¯´è¿‡Componentå¯ä»¥ä¾èµ–Component<br>è¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­<br>æˆ‘ä»¬æ–°å»ºPersonComponent</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Component(modules = PersonModule.class)</span><br><span class="line">public interface PersonComponent &#123;</span><br><span class="line">    @ChinaPersonAnn</span><br><span class="line">    Person getChinaPerson();</span><br><span class="line">    @AmericaPersonAnn</span><br><span class="line">    Person getAmericaPerson();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŠŠæˆ‘ä»¬çš„PersonManagerä¿®æ”¹ä¸€ä¸‹å»æ‰æ³¨è§£å¦‚:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class PersonManager &#123;</span><br><span class="line">    Person person;</span><br><span class="line">    @Inject</span><br><span class="line">    public PersonManager(Person _person)&#123;</span><br><span class="line">        this.person=_person;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String speak()&#123;</span><br><span class="line">        return person.speak();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ–°å»ºPersonManagerModule</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Module</span><br><span class="line">public class PersonManagerModule &#123;</span><br><span class="line">    @Provides</span><br><span class="line">    PersonManager providePersonManager(@ChinaPersonAnn Person _persion)&#123;</span><br><span class="line">        return new PersonManager(_persion);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ–°å»ºPersonManagerComponent</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Component(modules = PersonManagerModule.class,dependencies = PersonComponent.class)</span><br><span class="line">public interface PersonManagerComponent &#123;</span><br><span class="line">    PersonManager getManager();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MainActivityComponentä¿®æ”¹ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Component(dependencies=PersonManagerComponent.class)</span><br><span class="line">public interface MainActivityComponent&#123;</span><br><span class="line">    void inject(MainActivity activity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MainActivityä¿®æ”¹ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">DaggerMainActivityComponent.builder()</span><br><span class="line">                        .personManagerComponent(</span><br><span class="line">                            DaggerPersonManagerComponent.builder()</span><br><span class="line">                                    .personComponent(</span><br><span class="line">                                    DaggerPersonComponent.create()</span><br><span class="line">                            ).build()</span><br><span class="line">                        ).build()</span><br><span class="line">                .inject(this);</span><br><span class="line"></span><br><span class="line">@Inject</span><br><span class="line">PersonManager personManager;</span><br><span class="line"></span><br><span class="line">private void initListener() &#123;</span><br><span class="line">      tvTest.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">          @Override</span><br><span class="line">          public void onClick(View v) &#123;</span><br><span class="line"></span><br><span class="line">              Toast.makeText(MainActivity.this,  &quot;&quot;+personManager.speak(), Toast.LENGTH_SHORT).show();</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™å°±æ˜¯Componentçš„dependenciesçš„ç”¨æ³•ï¼ŒComponentä¾èµ–äº†å…¶ä»–Componentã€‚<br>å¦‚æœæ¢æˆSubcomponentï¼Œå¯ä»¥æŠŠå®ƒç†è§£ä¸ºç»§æ‰¿çš„å…³ç³»ï¼Œåˆ™ä¿®æ”¹Componentéƒ¨åˆ†å°±å¯ä»¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">@Component(modules = PersonModule.class)</span><br><span class="line">public interface PersonComponent2 &#123;</span><br><span class="line">    PersonManagerComponent2 personManagerComponent();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Subcomponent(modules = PersonManagerModule.class)</span><br><span class="line">public interface PersonManagerComponent2 &#123;</span><br><span class="line">    MainActivityComponent2 mainActivityComponent();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Subcomponent</span><br><span class="line">public interface MainActivityComponent2 &#123;</span><br><span class="line">    void Inject(MainActivity activity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainActivityä¿®æ”¹ä¸ºï¼š</span><br><span class="line"></span><br><span class="line">@Inject</span><br><span class="line">PersonManager personManager;</span><br><span class="line"></span><br><span class="line">DaggerPersonComponent2.create().personManagerComponent().mainActivityComponent().Inject(this);</span><br><span class="line"></span><br><span class="line">tvTest.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View v) &#123;</span><br><span class="line"></span><br><span class="line">                Toast.makeText(MainActivity.this,  &quot;&quot;+personManager.speak(), Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å¼€èµ·æ¥æœ‰äº›ä¸åˆå¸¸ç†ï¼ŒPersonComponent2ç®¡ç†äº†PersonManagerComponent2å’ŒMainActivityComponent2ã€‚<br>Dagger2ç”Ÿæˆçš„ä»£ç ä¸­ï¼ŒSubcomponentæ ‡è®°çš„ç±»æ˜¯Componpentçš„å†…éƒ¨ç±»ã€‚<br>å³MainActivityComponent2æ˜¯PersonManagerComponent2çš„å†…éƒ¨ç±»ï¼ŒPersonManagerComponent2åˆæ˜¯MainActivityComponent2çš„å†…éƒ¨ç±»ã€‚</p>
<p>æ¯”è¾ƒé€‚åˆä½¿ç”¨Subcomponentçš„å‡ ä¸ªåœºæ™¯ï¼š<br>å¾ˆå¤šå·¥å…·ç±»éƒ½éœ€è¦ä½¿ç”¨åˆ°Applicationçš„Contextå¯¹è±¡ï¼Œæ­¤æ—¶å°±å¯ä»¥ç”¨ä¸€ä¸ªComponentè´Ÿè´£æä¾›ï¼Œæˆ‘ä»¬å¯ä»¥å‘½åä¸ºAppComponentã€‚<br>éœ€è¦ç”¨åˆ°çš„contextå¯¹è±¡çš„SharePreferenceComponentï¼ŒToastComponentå°±å¯ä»¥å®ƒä½œä¸ºSubcomponentå­˜åœ¨äº†ã€‚</p>
<p>è€Œä¸”åœ¨AppComponentä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹åˆ°æœ‰å“ªäº›å­Componentï¼Œå› ä¸ºåœ¨é‡Œé¢æˆ‘ä»¬å®šä¹‰äº†å¾ˆå¤šXxxComponent (Moduleâ€¦ modules)</p>
<p>æ¯ä¸ªActivityComponentä¹Ÿæ˜¯å¯ä»¥ä½œä¸ºAppComponentçš„Subcomponentï¼Œè¿™æ ·å¯ä»¥æ›´æ–¹ä¾¿çš„è¿›è¡Œä¾èµ–æ³¨å…¥ï¼Œå‡å°‘é‡å¤ä»£ç ã€‚</p>
<p><strong>@Scopeå’Œ@Singleton</strong><br>One reason to break your applicationâ€™s component up into Subcomponents is to use scopes. With normal, unscoped bindings, each user of an injected type may get a new, separate instance. But if the binding is scoped, then all users of that binding within the scopeâ€™s lifetime get the same instance of the bound type.</p>
<p>ä¸Šé¢æ˜¯googleç»™çš„è§£é‡Šã€‚<br>ç®€å•ç†è§£ä¸ºåœ¨ä¸ä½¿ç”¨@Scopeçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½æ¯æ¬¡æ³¨å…¥çš„å¯¹è±¡éƒ½ä¼šæ˜¯ä¸€ä¸ªæ–°çš„ä¸åŒçš„å¯¹è±¡ï¼Œè€Œ@Scopeèƒ½é™åˆ¶è¢«æ³¨å…¥çš„å¯¹è±¡ï¼Œåœ¨åŒä¸€ä¸ª@Scopeçš„ç”Ÿå‘½å‘¨æœŸ(lifetime)ä¸­éƒ½åªå­˜åœ¨ä¸€ä¸ªä¸”ä»…æœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯ä¸æ˜¯å¾ˆåƒå•ä¾‹ã€‚</p>
<p>@Scopeæ˜¯æ ‡å¿—ä¸€ä¸ªæ³¨å…¥å™¨/å¯¹è±¡çš„ä½¿ç”¨èŒƒå›´ä¹Ÿå¯ä»¥è¯´æ˜¯ç”¨æ¥ç®¡ç†ä¾èµ–çš„ç”Ÿå‘½å‘¨æœŸï¼ˆä¹Ÿå¯ä»¥ç†è§£ä¸ºä½œç”¨åŸŸï¼‰çš„ã€‚å®ƒä¹Ÿæ˜¯ç”¨æ¥ä¿®é¥°æ³¨è§£çš„ï¼Œè€Œ@Singletonåˆ™æ˜¯@Scopeçš„å®ç°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Identifies a type that the injector only instantiates once. Not inherited.</span><br><span class="line"> *</span><br><span class="line"> * @see javax.inject.Scope @Scope</span><br><span class="line"> */</span><br><span class="line">@Scope</span><br><span class="line">@Documented</span><br><span class="line">@Retention(RUNTIME)</span><br><span class="line">public @interface Singleton &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>é¡¾åæ€ä¹‰@Scopeç”¨æ¥ç®¡ç†ç”Ÿå‘½å‘¨æœŸï¼Œæ‰€ä»¥æˆ‘ä»¬çš„å‘½åè¦å°½é‡è§„èŒƒè¯¦ç»†ï¼Œå¦‚ï¼š<br>ActivityScope<br>FragmentScope<br>ApplicationScope<br>ã€‚ã€‚ã€‚</p>
<p>@Scopeæ‰€æè¿°çš„æ³¨è§£ç”¨äºä¸¤ä¸ªåœ°æ–¹ï¼š</p>
<p>@Componentç±»<br>@Moduleä¸­@Providesæ–¹æ³•</p>
<p>å¦‚ä¸‹å†…å®¹å¼•ç”¨ï¼šã€‹ã€‹ã€‹<a href="https://www.jianshu.com/p/3028f491006b" target="_blank" rel="noopener">Dagger2 çŸ¥è¯†æ¢³ç†(4) - @Scope æ³¨è§£çš„ä½¿ç”¨</a> å¦‚æœ‰ä¾µæƒè¯·å‘ŠçŸ¥ï¼ï¼ï¼</p>
<p>åœ¨å•ä¸ªComponentæƒ…å†µä¸‹æ¥ä½¿ç”¨Scope</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">@Documented</span><br><span class="line">@Retention(RUNTIME)</span><br><span class="line">@Scope</span><br><span class="line">public @interface  TestScope &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PersonModule ä¸­</span><br><span class="line"></span><br><span class="line">@Provides</span><br><span class="line">@Named(&quot;China&quot;)</span><br><span class="line">@TestScope</span><br><span class="line">Person getChinaPerson()&#123;</span><br><span class="line">    return new ChinaPerson();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Provides</span><br><span class="line">@Named(&quot;America&quot;)</span><br><span class="line">Person getAmericaPerson()&#123;</span><br><span class="line">    return new AmericaPerson();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainActivityComponent ä¸­</span><br><span class="line"></span><br><span class="line">@Component(modules=PersonModule.class)</span><br><span class="line">@TestScope</span><br><span class="line">public interface MainActivityComponent&#123;</span><br><span class="line">    void inject(MainActivity activity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœåœ¨Moduleçš„@Providesæ–¹æ³•ä¸ŠåŠ ä¸Šäº†@Scopeå£°æ˜ï¼Œé‚£ä¹ˆåœ¨ä¸ä»–å…³è”çš„Componentä¸Šä¹Ÿå¿…é¡»åŠ ä¸Šç›¸åŒçš„@Scopeå£°æ˜<br>åœ¨Componentå®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼Œåªä¼šåˆ›å»ºä¸€ä¸ªç”±@Providesæ–¹æ³•è¿”å›çš„å®ä¾‹ï¼Œå¯ä»¥ç†è§£ä¸ºå±€éƒ¨å•ä¾‹ã€‚</p>
<p>åœ¨å¤šä¸ªComponentæƒ…å†µä¸‹æ¥ä½¿ç”¨Scope</p>
<p>åœ¨ä¾èµ–æˆ–è€…ç»§æ‰¿çš„ç»„ç»‡æ–¹å¼ä¸­ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªComponentå£°æ˜äº†@Scopeï¼Œé‚£ä¹ˆå…¶å®ƒçš„Componentä¹Ÿéœ€è¦å£°æ˜ã€‚<br>åœ¨ä¾èµ–å…³ç³»ä¸­ï¼Œè¢«ä¾èµ–çš„Componentå’Œéœ€è¦ä¾èµ–çš„Componentçš„@Scopeä¸èƒ½ç›¸åŒ</p>
<p><img src="2019-08-02-21-06-23.png" alt></p>
<p>åœ¨ä¾èµ–å…³ç³»ä¸­ï¼Œéœ€è¦ä¾èµ–çš„Componentçš„@Scopeä¸å¯ä»¥ä¸º@Singletonã€‚</p>
<p><img src="2019-08-02-21-06-41.png" alt></p>
<p>åœ¨ç»„ç»‡å…³ç³»ä¸­ï¼Œå­Componentçš„@Scopeä¸å¯ä»¥å’Œçˆ¶Componentçš„@Scopeç›¸åŒï¼š</p>
<p><img src="2019-08-02-21-06-49.png" alt></p>
<p>åœ¨ç»„ç»‡å…³ç³»ä¸­ï¼Œå¦‚æœçˆ¶Componentçš„@Scopeä¸ä¸º@Singletonï¼Œé‚£ä¹ˆå­Componentçš„@Scopeå¯ä»¥ä¸º@Singletonã€‚</p>
<p>è¿™äº›é™åˆ¶æ˜¯ç”±Dagger2åœ¨ç¼–è¯‘æ—¶å»æ£€æŸ¥çš„ï¼Œå…¶ç›®çš„æ˜¯ä¿è¯ä½¿ç”¨è€…ä¸è¦å¯¹@Scopeäº§ç”Ÿæ»¥ç”¨çš„ç°è±¡ï¼Œå› ä¸º@Scopeçš„ç›®çš„æ˜¯ åœ¨ç‰¹å®šä½œç”¨åŸŸå†…æ§åˆ¶è¢«æ³¨å…¥å®ä¾‹çš„å¤ç”¨</p>
<p>ç¤ºä¾‹ï¼š<br>(1) ScopeApp<br>å¯¹åº”äºæˆ‘ä»¬å¹³æ—¶çš„Applicationç±»ï¼Œå¹¶æä¾›äº†å…¨å±€çš„ScopeAppDataç±»ï¼Œåœ¨å…¶ScopeAppComponentä¸Šæœ‰@Singletonæ³¨è§£ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Singleton</span><br><span class="line">@Component(modules = &#123;ScopeAppModule.class&#125;)</span><br><span class="line">public interface ScopeAppComponent &#123;</span><br><span class="line">    public ScopeAppData getScopeAppData(); //å¦‚æœå®ƒè¢«å…¶å®ƒçš„Componentä¾èµ–ï¼Œé‚£ä¹ˆéœ€è¦å£°æ˜getXXXæ–¹æ³•ã€‚</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Module</span><br><span class="line">public class ScopeAppModule &#123;</span><br><span class="line"></span><br><span class="line">    @Provides</span><br><span class="line">    @Singleton</span><br><span class="line">    public ScopeAppData provideScopeAppData() &#123;</span><br><span class="line">        return new ScopeAppData();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>(2) ScopeActivity<br>å¯¹åº”äºä¸€ä¸ªä¸»é¡µé¢ï¼Œå…¶å†…éƒ¨åŒ…å«äº†ScopeActivitySharedDataå’ŒScopeActivityNormalDataï¼Œå‰è€…åœ¨ScopeActivityComponentçš„ç”Ÿå‘½å‘¨æœŸå†…ä¿æŒå”¯ä¸€æ€§ï¼Œå¹¶å¸¦æœ‰PerScopeActivityæ³¨è§£ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@Component(dependencies = &#123;ScopeAppComponent.class&#125;, modules = &#123;ScopeActivityModule.class&#125;)</span><br><span class="line">@PerScopeActivity</span><br><span class="line">public interface ScopeActivityComponent &#123;</span><br><span class="line">    public void inject(ScopeActivity scopeActivity);</span><br><span class="line">    ScopeFragmentComponent scopeFragmentComponent();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Module</span><br><span class="line">public class ScopeActivityModule &#123;</span><br><span class="line"></span><br><span class="line">    @Provides</span><br><span class="line">    @PerScopeActivity</span><br><span class="line">    public ScopeActivitySharedData provideScopeActivityData() &#123;</span><br><span class="line">        return new ScopeActivitySharedData();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Provides</span><br><span class="line">    public ScopeActivityNormalData provideScopeActivityNormalData() &#123;</span><br><span class="line">        return new ScopeActivityNormalData();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>(3) ScopeFragment<br>å¯¹äºäºActivityä¸‹çš„ä¸€ä¸ªå­ç•Œé¢ï¼Œå®ƒå’ŒScopeActivityComponentæ˜¯ç»§æ‰¿å…³ç³»ï¼Œå¹¶å¸¦æœ‰@PerScopeFragmentæ³¨è§£ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Subcomponent(modules = &#123;ScopeFragmentModule.class&#125;)</span><br><span class="line">@PerScopeFragment</span><br><span class="line">public interface ScopeFragmentComponent &#123;</span><br><span class="line">    public void inject(ScopeFragment scopeFragment);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Module</span><br><span class="line">public class ScopeFragmentModule &#123;</span><br><span class="line"></span><br><span class="line">    @Provides</span><br><span class="line">    @PerScopeFragment</span><br><span class="line">    public ScopeFragmentData provideScopeFragmentData() &#123;</span><br><span class="line">        return new ScopeFragmentData();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä¸‰ä¸ªéƒ¨åˆ†çš„å…³ç³»ä¸ºï¼š</p>
<p>ScopeActivityComponentä¾èµ–äºScopeAppComponent</p>
<p>ScopeFragmentComponentç»§æ‰¿äºScopeActivityComponent</p>
<p>å®ƒä»¬çš„Moduleä¸Šéƒ½æœ‰ç”¨@Scopeæè¿°çš„æ³¨è§£ï¼š@Singletonã€@PerScopeActivityï¼Œ@PerScopeFragmentã€‚</p>
<p>éªŒè¯ä¸€ä¸‹ï¼š</p>
<p>App</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class ScopeApp extends Application &#123;</span><br><span class="line"></span><br><span class="line">    private ScopeAppComponent mScopeAppComponent;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onCreate() &#123;</span><br><span class="line">        super.onCreate();</span><br><span class="line">        mScopeAppComponent = DaggerScopeAppComponent.builder().scopeAppModule(new ScopeAppModule()).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public ScopeAppComponent getAppComponent() &#123;</span><br><span class="line">        return mScopeAppComponent;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Activityç±»</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">public class ScopeActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    private static final String TAG = ScopeActivity.class.getSimpleName();</span><br><span class="line"></span><br><span class="line">    private ScopeActivityComponent mScopeActivityComponent;</span><br><span class="line"></span><br><span class="line">    @Inject</span><br><span class="line">    ScopeAppData mScopeAppData;</span><br><span class="line"></span><br><span class="line">    @Inject</span><br><span class="line">    ScopeActivitySharedData mScopeActivitySharedData1;</span><br><span class="line"></span><br><span class="line">    @Inject</span><br><span class="line">    ScopeActivitySharedData mScopeActivitySharedData2;</span><br><span class="line"></span><br><span class="line">    @Inject</span><br><span class="line">    ScopeActivityNormalData mScopeActivityNormalData1;</span><br><span class="line"></span><br><span class="line">    @Inject</span><br><span class="line">    ScopeActivityNormalData mScopeActivityNormalData2;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_scope);</span><br><span class="line">        getScopeActivityComponent().inject(this);</span><br><span class="line">        TextView tvData = (TextView) findViewById(R.id.tv_scope_activity);</span><br><span class="line">        String result = &quot;[ScopeActivity Space] \n mScopeAppData=&quot; + mScopeAppData</span><br><span class="line">                + &quot;\n\n&quot; + &quot;mScopeActivitySharedData1=&quot; + mScopeActivitySharedData1</span><br><span class="line">                + &quot;\n\n&quot; + &quot;mScopeActivitySharedData2=&quot; + mScopeActivitySharedData2</span><br><span class="line">                + &quot;\n\n&quot; + &quot;mScopeActivityNormalData1=&quot; + mScopeActivityNormalData1</span><br><span class="line">                + &quot;\n\n&quot; + &quot;mScopeActivityNormalData2=&quot; + mScopeActivityNormalData2;</span><br><span class="line">        tvData.setText(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public ScopeActivityComponent getScopeActivityComponent() &#123;</span><br><span class="line">        if (mScopeActivityComponent == null) &#123;</span><br><span class="line">            ScopeAppComponent scopeAppComponent = ((ScopeApp) getApplication()).getAppComponent();</span><br><span class="line">            mScopeActivityComponent = DaggerScopeActivityComponent.builder().scopeAppComponent(scopeAppComponent).build();</span><br><span class="line">        &#125;</span><br><span class="line">        return mScopeActivityComponent;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Fragmentç±»</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">public class ScopeFragment extends Fragment &#123;</span><br><span class="line"></span><br><span class="line">    private ScopeActivity mScopeActivity;</span><br><span class="line"></span><br><span class="line">    @Inject</span><br><span class="line">    ScopeAppData mScopeAppData;</span><br><span class="line"></span><br><span class="line">    @Inject</span><br><span class="line">    ScopeActivitySharedData mScopeActivitySharedData;</span><br><span class="line"></span><br><span class="line">    @Inject</span><br><span class="line">    ScopeActivityNormalData ScopeActivityNormalData;</span><br><span class="line"></span><br><span class="line">    @Inject</span><br><span class="line">    ScopeFragmentData mScopeFragmentData;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onAttach(Context context) &#123;</span><br><span class="line">        super.onAttach(context);</span><br><span class="line">        mScopeActivity = (ScopeActivity) context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Nullable</span><br><span class="line">    @Override</span><br><span class="line">    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, Bundle savedInstanceState) &#123;</span><br><span class="line">        View rootView = inflater.inflate(R.layout.fragment_scope, container, false);</span><br><span class="line">        mScopeActivity.getScopeActivityComponent().scopeFragmentComponent().inject(this);</span><br><span class="line">        TextView tv = (TextView) rootView.findViewById(R.id.tv_scope_fragment);</span><br><span class="line">        String result = &quot;[ScopeFragment Space] \n mScopeAppData=&quot; + mScopeAppData</span><br><span class="line">                + &quot;\n\n&quot; + &quot;mScopeActivitySharedData1=&quot; + mScopeActivitySharedData</span><br><span class="line">                + &quot;\n\n&quot; + &quot;ScopeActivityNormalData=&quot; + ScopeActivityNormalData</span><br><span class="line">                + &quot;\n\n&quot; + &quot;mScopeFragmentData=&quot; + mScopeFragmentData;</span><br><span class="line">        tv.setText(result);</span><br><span class="line">        return rootView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onDestroy() &#123;</span><br><span class="line">        super.onDestroy();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”±ä¸Šé¢ä¾‹å­ä¸­çš„ç°è±¡ï¼Œå¯ä»¥æ€»ç»“å‡ºä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<p>ScopeAppDataï¼šè¯¥æ•°æ®æ˜¯ç”±ScopeAppModuleæä¾›çš„ï¼Œè€Œå®ƒåŠ ä¸Šäº†@Singletonæ³¨è§£ï¼Œå¹¶ä¸”æˆ‘ä»¬è°ƒç”¨çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤åœ¨Activityå’ŒFragmentä¸­åœ°å€ç›¸åŒã€‚</p>
<p>ScopeActivitySharedDataï¼šåœ¨å®ƒçš„provideæ–¹æ³•ä¸Šï¼Œæˆ‘ä»¬åŠ ä¸Šäº†@PerScopeActivityæ³¨è§£ï¼Œå› æ­¤åœ¨Activityå’ŒFragmentä¸­ï¼Œå®ƒçš„åœ°å€ç›¸åŒã€‚</p>
<p>ScopeActivityNormalDataï¼šè™½ç„¶åœ¨æä¾›å®ƒçš„ScopeActivityModuleä¸­åŠ ä¸Šäº†@PerScopeActivityæ³¨è§£ï¼Œä½†æ˜¯åœ¨provideæ–¹æ³•ä¸Šæ²¡æœ‰å£°æ˜ï¼Œå› æ­¤æ— è®ºæ˜¯åœ¨Activityï¼Œè¿˜æ˜¯åœ¨Fragmentä¸­ï¼Œéƒ½æ˜¯æŒ‡å‘ä¸åŒçš„åœ°å€ã€‚</p>
<p>ScopeFragmentDataï¼šç”¨äºæ¼”ç¤ºå¦‚ä½•é€šè¿‡ç»§æ‰¿çš„æ–¹å¼ï¼Œæ¥å®ç°ä¾èµ–æ³¨å…¥ã€‚</p>
<p><strong>Setæ³¨å…¥ Mapæ³¨å…¥ @MapKey</strong><br><strong>Setæ³¨å…¥</strong><br>ä¹‹å‰çš„æ³¨å…¥éƒ½æ˜¯å•ä¸ªå¯¹è±¡ï¼ŒSetæ³¨å…¥å³å¯ä»¥å°†å¤šä¸ªå¯¹è±¡æ³¨å…¥åˆ°Setä¸­ã€‚<br>æˆ‘ä»¬ä½¿ç”¨PersonModuleåŠ å…¥@IntoSetåŠ å…¥åˆ°Setä¸­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">@Module</span><br><span class="line">public class PersonModule &#123;</span><br><span class="line"></span><br><span class="line">    @Provides</span><br><span class="line">    @IntoSet</span><br><span class="line">    Person getChinaPerson()&#123;</span><br><span class="line">        return new ChinaPerson();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Provides</span><br><span class="line">    @IntoSet</span><br><span class="line">    Person getAmericaPerson()&#123;</span><br><span class="line">        return new AmericaPerson();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainActivity ä¸­ï¼š</span><br><span class="line"></span><br><span class="line">@Inject</span><br><span class="line">Set&lt;Person&gt; personSet;</span><br><span class="line"></span><br><span class="line">tvTest.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View v) &#123;</span><br><span class="line">                for (Person person:</span><br><span class="line">                     personSet) &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.this, &quot;&quot;+person.speak(), Toast.LENGTH_SHORT).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼åŒæ—¶å‘Setæ³¨å…¥å¤šä¸ªå¯¹è±¡ï¼š<br>PersonModule.java</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Provides</span><br><span class="line">@ElementsIntoSet</span><br><span class="line">public Set&lt;Person&gt; getPlayers()&#123;</span><br><span class="line">    HashSet set =  new HashSet&lt;&gt;();</span><br><span class="line">    set.add(new ChinaPerson());</span><br><span class="line">    set.add(new AmericaPerson());</span><br><span class="line">    return set;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨@ElementsIntoSet å¹¶ä¸”è¿”å›Setå¯¹è±¡</p>
<p><strong>Mapæ³¨å…¥</strong><br>Mapæ³¨å…¥ä¸Setæ³¨å…¥çš„åŒºåˆ«æ˜¯Mapæ³¨å…¥éœ€è¦Keyï¼Œå¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">@Provides</span><br><span class="line">@IntoMap</span><br><span class="line">@StringKey(&quot;china&quot;)</span><br><span class="line">Person getChinaPerson()&#123;</span><br><span class="line">    return new ChinaPerson();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Provides</span><br><span class="line">@IntoMap</span><br><span class="line">@StringKey(&quot;America&quot;)</span><br><span class="line">Person getAmericaPerson()&#123;</span><br><span class="line">    return new AmericaPerson();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainActivity ä¸­ï¼š</span><br><span class="line">@Inject</span><br><span class="line">Map&lt;String,Person&gt; personMap;</span><br><span class="line"></span><br><span class="line">tvTest.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View v) &#123;</span><br><span class="line">                for (Map.Entry&lt;String,Person&gt; person:</span><br><span class="line">                     personMap.entrySet()) &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.this, &quot;&quot;+person.getKey()+&quot; &quot;+person.getValue().speak(), Toast.LENGTH_SHORT).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<p>daggerè¿˜æä¾›äº†ä¸€äº›å†…ç½®çš„keyç±»å‹ï¼ŒåŒ…è£¹classKey,IntKeyç­‰ï¼Œandroidè¾…åŠ©åŒ…ä¸­ä¹Ÿæä¾›äº†ActivityKeyç­‰ã€‚</p>
<p>æˆ‘ä»¬çœ‹çœ‹StringKeyçš„æºç ,æ˜¯è¢«MapKeyä¿®é¥°çš„ï¼Œä¸‹é¢æˆ‘ä»¬æ¥èŠèŠMapkeyã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Documented</span><br><span class="line">@Target(METHOD)</span><br><span class="line">@Retention(RUNTIME)</span><br><span class="line">@MapKey</span><br><span class="line">public @interface StringKey &#123;</span><br><span class="line">  String value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>@MapKey</strong><br>MapKeyæ”¯æŒçš„ç±»å‹æœ‰ï¼š<br>åŸºæœ¬æ•°æ®ç±»å‹<br>String<br>Class<br>æšä¸¾ç±»å‹<br>æ³¨è§£ç±»å‹<br>ä»¥ä¸Šæ•°æ®ç±»å‹çš„æ•°ç»„<br>Enum<br>å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">enum MyEnum &#123;</span><br><span class="line">  ABC, DEF;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@MapKey</span><br><span class="line">@interface MyEnumKey &#123;</span><br><span class="line">  MyEnum value();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@MapKey</span><br><span class="line">@interface MyNumberClassKey &#123;</span><br><span class="line">  Class&lt;? extends Number&gt; value();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Module</span><br><span class="line">class MyModule &#123;</span><br><span class="line">  @Provides @IntoMap</span><br><span class="line">  @MyEnumKey(MyEnum.ABC)</span><br><span class="line">  static String provideABCValue() &#123;</span><br><span class="line">    return &quot;value for ABC&quot;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @Provides @IntoMap</span><br><span class="line">  @MyNumberClassKey(BigDecimal.class)</span><br><span class="line">  static String provideBigDecimalValue() &#123;</span><br><span class="line">    return &quot;value for BigDecimal&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¤åˆKeyï¼Œå¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@MapKey(unwrapValue = false)</span><br><span class="line">@Retention(value=RUNTIME)</span><br><span class="line">public @interface GameInfo &#123;</span><br><span class="line">    String name();</span><br><span class="line">    float price();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Module</span><br><span class="line">public class GameModule &#123;</span><br><span class="line">    @Provides</span><br><span class="line">    @IntoMap</span><br><span class="line">    @GameInfo(name = &quot;game&quot;,price = 100f)</span><br><span class="line">    public String getGameInfo()&#123;</span><br><span class="line">        return &quot;gameinfo&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MainActivity ä¸­ï¼š</span><br><span class="line"></span><br><span class="line">@Inject</span><br><span class="line">Map&lt;GameInfo,String&gt; mGameInfoStringMap;</span><br></pre></td></tr></table></figure>

<p>å¦‚ä¸Šå¦‚æœç¼–è¯‘å¤±è´¥ï¼Œè¦åŠ å…¥å¦‚ä¸‹ä¾èµ–ï¼š<br>implementation â€˜com.google.auto.value:auto-value:1.5.1â€™<br>provided â€˜javax.annotation:jsr250-api:1.0â€™</p>
<p><strong>Lazy å’Œ Provider</strong><br>Dagger2è¿˜æ”¯æŒLazyæ¨¡å¼ï¼Œé€šè¿‡Lazyæˆ–è€…Provideræ¨¡æ‹Ÿæä¾›çš„å®ä¾‹ï¼Œåœ¨@Injectçš„æ—¶å€™å¹¶ä¸åˆå§‹åŒ–ï¼Œè€Œæ˜¯ç­‰åˆ°ä½ è¦ä½¿ç”¨çš„æ—¶å€™ï¼Œä¸»åŠ¨è°ƒç”¨å…¶.getæ–¹æ³•æ¥è·å–å®ä¾‹ã€‚</p>
<p>å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Inject</span><br><span class="line">Lazy&lt;PersonManager&gt; personManager;</span><br><span class="line"></span><br><span class="line">@Inject</span><br><span class="line">Provider&lt;PersonManager&gt; personManager;</span><br><span class="line"></span><br><span class="line">tvTest.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View v) &#123;</span><br><span class="line">                Toast.makeText(MainActivity.this,  &quot;&quot;+personManager.get().speak(), Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<p>Lazyå’ŒProviderçš„åŒºåˆ«åœ¨äºï¼š</p>
<p>Lazyæ¯æ¬¡getéƒ½æ˜¯åŒä¸€å®ä¾‹<br>Provideræ¯æ¬¡getéƒ½æ˜¯æ–°å®ä¾‹</p>
<p><strong>åè¯è§£é‡Šï¼š</strong></p>
<p>JSR-330<br>JSRå³Java Specification Requestsï¼Œæ„æ€æ˜¯javaè§„èŒƒæè¦ã€‚<br>è€ŒJSR-330åˆ™æ˜¯ Javaä¾èµ–æ³¨å…¥æ ‡å‡†</p>
<p>æœ¬æ–‡å‚è€ƒæ–‡ç« :</p>
<p><a href="https://blog.csdn.net/heng615975867/article/details/80355090" target="_blank" rel="noopener">Dagger2 æœ€æ¸…æ™°çš„ä½¿ç”¨æ•™ç¨‹</a><br><a href="https://my.oschina.net/zzxzzg/blog/1541916" target="_blank" rel="noopener">Dagger2 ä½¿ç”¨ï¼ˆäºŒï¼‰</a></p>

            <br />
            <p class="meta">
                

<a href="/tags/Android/"> <i class="fas fa-tags"></i>
    Android </a>

            </p>
        </div>

        <div class="col-sm-4">
            

<span><b>
        TL;DR</b></span>
<p>
    Yet another hexo theme.
</p>
<hr />


<span><b>
        TL;DR 2</b></span>
<p>
    No, not another one :/
</p>
<hr />






<span><a href="https://twitter.com/hexojs" target="_blank" rel="noopener"><b><i class="fab fa-twitter-square"></i>
            <i class="fas fa-at"></i>
            hexojs</b></a></span>
<br />
<a class="twitter-timeline" data-height="800" data-dnt="true" data-chrome="nofooter transparent noheader noborders "
    href="https://twitter.com/hexojs?ref_src=twsrc%5Etfw"></a>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

        </div>
    </div>
</div>
<!-- Menu fade on scroll -->
<script>
    var isScrolling;
    var prevScrollpos = window.pageYOffset;
    window.addEventListener('scroll', function (event) {
        window.clearTimeout(isScrolling);
        isScrolling = setTimeout(function () {
            var currentScrollPos = window.pageYOffset;
            if (prevScrollpos > currentScrollPos) {
                $("#navbar").slideDown();
            } else {
                $("#navbar").slideUp();
            }
            prevScrollpos = currentScrollPos;
        }, 66);
    }, false);
</script>


<a class="float-right gradient btn paginationbtn" href="/2019/08/03/Androidç»„ä»¶åŒ–å¼€å‘/"><i class="fas fa-chevron-right"></i></a>

    </main>
    <!-- Footer -->
    <footer class="page-footer">
  <div class="container">
    <div class="social-icons">
      
      <a href="https://hexo.io/" title="Hexo.io" target="_blank" rel="noopener" class="fas fa-home"></a>
      
      <a href="https://twitter.com/hexojs" title="@hexojs" target="_blank" rel="noopener" class="fab fa-twitter"></a>
      
      <a href="https://github.com/RandomAdversary/Gradient/issues" title="Report issue" target="_blank" rel="noopener" class="fas fa-bug"></a>
      
    </div>
  </div>
</footer>
    <!-- After footer scripts -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>
</body>

</html>